<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>📗 Student Scores</title>
  </head>
  <body>
    <script>
      /**
       * Random data * over 40 rows (class, gender, name, score - kor, eng, math)
       */
      const dataFrame = [
        [4, "여", "정서연", 97, 27, 35],
        [2, "여", "김도윤", 54, 80, 76],
        [2, "남", "정지우", 90, 11, 50],
        [2, "여", "박예준", 82, 88, 68],
        [4, "남", "박서연", 14, 56, 41],
        [3, "여", "최민준", 52, 61, 85],
        [2, "여", "박서연", 15, 18, 42],
        [2, "여", "이민준", 44, 91, 98],
        [2, "남", "최민준", 51, 81, 64],
        [2, "남", "이민준", 86, 40, 90],
        [4, "여", "최도윤", 99, 90, 16],
        [4, "여", "김도윤", 93, 17, 41],
        [2, "남", "최민준", 14, 58, 54],
        [2, "여", "박도윤", 57, 16, 13],
        [2, "남", "김예린", 51, 79, 21],
        [2, "남", "최하윤", 61, 69, 82],
        [1, "남", "이지우", 96, 31, 35],
        [4, "여", "정서연", 97, 27, 35],
        [2, "여", "김도윤", 54, 80, 76],
        [2, "남", "정지우", 90, 11, 50],
        [2, "여", "박예준", 82, 88, 68],
        [4, "남", "박서연", 14, 56, 41],
        [3, "여", "최민준", 52, 61, 85],
        [2, "여", "박서연", 15, 18, 42],
        [2, "여", "이민준", 44, 91, 98],
        [2, "남", "최민준", 51, 81, 64],
        [2, "남", "이민준", 86, 40, 90],
        [4, "여", "최도윤", 99, 90, 16],
        [4, "여", "김도윤", 93, 17, 41],
        [2, "남", "최민준", 14, 58, 54],
        [2, "여", "박도윤", 57, 16, 13],
        [2, "남", "김예린", 51, 79, 21],
        [2, "남", "최하윤", 61, 69, 82],
        [1, "남", "이지우", 96, 31, 35],
        [4, "여", "정서연", 97, 27, 35],
        [2, "여", "김도윤", 54, 80, 76],
        [2, "남", "정지우", 90, 11, 50],
        [2, "여", "박예준", 82, 88, 68],
        [4, "남", "박서연", 14, 56, 41],
        [3, "여", "최민준", 52, 61, 85],
        [2, "여", "박서연", 15, 18, 42],
        [2, "여", "이민준", 44, 91, 98],
        [2, "남", "최민준", 51, 81, 64],
        [2, "남", "이민준", 86, 40, 90],
        [4, "여", "최도윤", 99, 90, 16],
        [4, "여", "김도윤", 93, 17, 41],
        [2, "남", "최민준", 14, 58, 54],
        [2, "여", "박도윤", 57, 16, 13],
        [2, "남", "김예린", 51, 79, 21],
        [2, "남", "최하윤", 61, 69, 82],
        [1, "남", "이지우", 96, 31, 35],
      ];

      /**
       * Append sum and average
       */
      for (const row of dataFrame) {
        // Get entire scores and return result of sum and average
        const kor = row[3];
        const eng = row[4];
        const math = row[5];

        const sum = kor + eng + math;
        const average = sum / 3;
        row.push(sum, Number(average.toFixed(2)));
      }

      /**
       * Set the grade of each average
       */
      const backgroundColors = []; // backgroundColor will be stored and apply on style.

      for (const row of dataFrame) {
        const average = row[row.length - 1];

        let grade = []; // ex) [grade, color]

        // Grade standard (score >= 90 - '수', score >= 80 - '우'... etc.)
        if (average >= 90) {
          grade = ["수", "red"];
        } else if (average >= 80) {
          grade = ["우", "orange"];
        } else if (average >= 70) {
          grade = ["미", "yellow"];
        } else if (average >= 60) {
          grade = ["양", "green"];
        } else {
          grade = ["가", "skyblue"];
        }

        row.push(grade[0]);
        backgroundColors.push(grade[1]);
      }

      /**
       * 2. Sort rank of entire students (Descending order by bubble sort)
       */
      let lastSortedCount = 1;

      for (i = 0; i < dataFrame.length - 1; i++) {
        for (j = 0; j < dataFrame.length - lastSortedCount; j++) {
          let currentRowAverage = dataFrame[j][7];
          let nextRowAverage = dataFrame[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = dataFrame[j + 1];
            dataFrame[j + 1] = dataFrame[j];
            dataFrame[j] = temp;
          }
        }

        lastSortedCount++;
      }

      /**
       * 4. Sort rank by gender
       */
      lastSortedCount = 1;

      // Seperate row by gender
      const maleGroup = [];
      const femaleGroup = [];

      for (const row of dataFrame) {
        row[1] === "남" ? maleGroup.push(row) : femaleGroup.push(row);
      }

      // Bubble sort by rank of each group
      for (i = 0; i < maleGroup.length - 1; i++) {
        for (j = 0; j < maleGroup.length - lastSortedCount; j++) {
          let currentRowAverage = maleGroup[j][7];
          let nextRowAverage = maleGroup[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = maleGroup[j + 1];
            maleGroup[j + 1] = maleGroup[j];
            maleGroup[j] = temp;
          }
        }

        lastSortedCount++;
      }

      // Initialize
      lastSortedCount = 1;

      for (i = 0; i < femaleGroup.length - 1; i++) {
        for (j = 0; j < femaleGroup.length - lastSortedCount; j++) {
          let currentRowAverage = femaleGroup[j][7];
          let nextRowAverage = femaleGroup[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = femaleGroup[j + 1];
            femaleGroup[j + 1] = femaleGroup[j];
            femaleGroup[j] = temp;
          }
        }

        lastSortedCount++;
      }
    </script>
  </body>
</html>
