<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04_teamplay</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .logo1 {
            font-size: 2rem;
            color: #fff;
            background-color: #000000;
            font-weight: bold;
            text-align: center;
            height: 50px;
            line-height: 50px;
        }


        .row {
            display: flex;
            align-items: center;
            background-color: #000000;
            color: white;
            font-weight: bold;
            font-size: 1.2em;
        }

        .cell {
            flex: 1;
            padding: 12px 10px;
            border-top: 1px solid #463c3c;
            border-right: 1px solid #463c3c;
            text-align: center;
        }

        .allrow {
            display: flex;
            background-color: #302929;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 1em;
        }

        .allcell {
            flex: 1;
            text-align: center;
            border-right: 1px solid #463c3c;
            border-bottom: 1px solid #463c3c
        }

        .su {
            color: #f00;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .woo {
            color: #fa0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .mi {
            color: #ff0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .yang {
            color: #0f0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .ga {
            color: rgb(102, 102, 236);
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <script>
        let studs = [ // 전체 등수
            [1, "여", "정서연", 97, 90, 92],
            [1, "여", "김도윤", 54, 80, 76],
            [3, "남", "정지우", 90, 11, 50],
            [3, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 14, 56, 98],
            [3, "남", "최민준", 52, 61, 85],
            [4, "여", "박서연", 15, 18, 42],
            [2, "남", "이민준", 90, 97, 98],
            [3, "남", "최민준", 51, 81, 64],
            [2, "남", "이민준", 86, 40, 90],
            [4, "여", "최도윤", 99, 90, 16],
            [4, "여", "김도윤", 93, 17, 98],
            [1, "남", "최민준", 14, 58, 54],
            [2, "여", "박도윤", 57, 16, 13],
            [1, "여", "김예린", 90, 97, 21],
            [1, "여", "최하윤", 61, 69, 82],
            [1, "남", "이지우", 96, 31, 35],
            [4, "여", "정서연", 97, 27, 35],
            [2, "여", "김도윤", 54, 80, 76],
            [2, "남", "정지우", 90, 11, 50],
            [2, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 14, 56, 98],
            [3, "여", "최민준", 52, 61, 85],
            [4, "여", "박서연", 15, 18, 42],
            [3, "여", "이민준", 90, 97, 98],
            [1, "남", "최민준", 51, 81, 64],
            [3, "남", "이민준", 86, 40, 90],
            [4, "남", "최도윤", 99, 90, 16],
            [3, "남", "김도윤", 93, 17, 98],
            [2, "남", "최민준", 14, 58, 54],
            [2, "여", "박도윤", 57, 16, 13],
            [2, "여", "김예린", 90, 97, 21],
            [2, "남", "최하윤", 61, 69, 82],
            [1, "여", "이지우", 96, 31, 35],
            [4, "여", "정서연", 97, 27, 35],
            [2, "여", "김도윤", 54, 80, 76],
            [3, "남", "정지우", 90, 11, 50],
            [1, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 99, 56, 98],
            [3, "남", "최민준", 52, 61, 85],
            [1, "여", "박서연", 15, 18, 42],
            [3, "남", "이민준", 90, 97, 98],
            [2, "남", "최민준", 51, 81, 64],
            [3, "남", "이민준", 86, 70, 90],
            [4, "여", "최도윤", 99, 90, 16],
            [4, "여", "김도윤", 93, 17, 98],
            [2, "남", "최민준", 14, 58, 54],
            [2, "남", "박도윤", 57, 16, 13],
            [1, "여", "김예린", 90, 97, 21],
            [2, "남", "최하윤", 61, 69, 82],
            [1, "남", "이지우", 96, 99, 35],
        ];

        for (let i in studs) { // 총점과 평균
            let tot = 0;
            let score = studs[i].slice(3)
            for (let j of studs[i].slice(3)) {
                tot += j;
            }
            studs[i].push(tot);
            studs[i].push((((tot / 3) * 100) | 0) / 100);
        }

        /*studs는 0~50까지 있으면 'in'은 인덱스 개수를 의미 i는 0부터 50까지를 살펴봄.
          tot(총점)은 0으로 맞추고, i번째 배열의 인덱스 개수가 3번째인 것부터 끝까지 '97, 90, 92'
          이중 반복문 for of는 '97, 90, 92'의 원소를 보겠다. 즉, 97부터 차례대로 반복해서 92가 되면 끝내겠다는 뜻

          i = 0, j = 0
          tot(=0) = 0 + 97;
          tot(=97) = 97 + 90;
          tot(=187) = 187 + 92;
          tot = 279;

          studs[i=0].push(tot); <-- push : 마지막에 삽입. 그러면 [0][6]에 279가 위치 / 인덱스 6추가
          studs[i=0].push((((tot / 3) * 100) | 0) / 100);; <-- 평균값 구하기. 소수점 두자리까지 구하기 위함. 마지막에 삽입 / 인덱스 7추가

          그렇게 i가 50이 될 때까지 반복해주는 것임.
          그러면 studs 안에 각 배열에 인덱스 6, 7이 추가되면서 그 안에 합계와 평균값이 나옴.
          */

        for (let i in studs) { // 등급
            let grade = 0;
            const a = studs[i][7]

            if (a >= 90) {
                grade = `<div class="su">수</div>`
            }
            else if (a >= 80) {
                grade = `<div class="woo">우</div>`
            }

            else if (a >= 70) {
                grade = `<div class="mi">미</div>`
            }

            else if (a >= 60) {
                grade = `<div class="yang">양</div>`
            }

            else {
                grade = `<div class="ga">가</div>`
            }

            studs[i].push(grade)
        }

        /*
        studs는 0~50까지 있으면 'in'은 인덱스 개수를 의미 i는 0부터 50까지를 살펴봄.
        grade는 0으로 맞추고, a 역시 studs[i=0][7=평균]으로 변수를 선언한다. 평균을 통해 등급이 매겨지기 때문
        처음에는 이중 for문으로 of 를 사용하려 했으나, studs2[i][7]은 고정값이라 반복하지 않아도 되어서 그냥 if문을 썼다.
        studs[i][7] = studs 배열의 인덱스 개수인 'i'의 평균
        90이면 수, 80이면 우, 70이면 미, 60이면 양, 나머지는 가로 설정하고 
        studs[i=0].push(grade); <-- push : 마지막에 삽입. 그러면 각 평균에 따른 등급이 매겨진다. / 인덱스 8추가
        
        */



        for (let my_rank in studs) { // 등수
            let rank = 1;
            for (let your_rank in studs) {
                if (studs[my_rank][7] < studs[your_rank][7]) {
                    rank++
                }
            }
            studs[my_rank].push(rank)
        }

        /*
        studs의 인덱스 0~50까지를 변수 my_rank에 넣어놓는다. 
        rank = 1을 선언한다. 왜냐하면 1위부터 시작하기 때문이다.
        나의 순위와 너희들의 순위를 비교하여 교차검증하는 방식.
        if문 안에서 studs[my_rank=0][7] 나의 평균점수가 < studs[your_rank=0][7] 너의 평균점수보다 작으면
        rank++ 랭크를 1씩 증가시키겠다. 
        현재 studs[0][7]과 studs[0][7]은 같기에 위로 올라가서 your_rank에 1을 올린다.
        studs[my_rank=0][7] < studs[your_rank=1][7]
        studs[my_rank=0][7] < studs[your_rank=2][7]
        studs[my_rank=0][7] < studs[your_rank=3][7]
        studs[my_rank=0][7] < studs[your_rank=4][7]
        studs[my_rank=0][7] < studs[your_rank=5][7]
        studs[my_rank=0][7] < studs[your_rank=6][7]
        studs[my_rank=0][7] < studs[your_rank=7][7] <-- 이때 studs[7][7]이 studs[0][7]보다 평균점수가 높기에 my_rank안에 등수는 2가 된다.

        그렇게 studs[my_rank=0][7]을 50번 반복한 후, [my_rank=1][7]에 들어가서 또 반복 점수 비교를 통해 순위를 교차 검증한다.
        그러면 배열 안에 학생들의 등수를 알 수 있다. 그리고 studs[my_rank].push(rank)를 통해 my_rank가 0~50일 때, 각 랭크가 배열에 맨 뒤에 생긴다.
        인덱스 9추가
        */

        for (let i = 0; i < studs.length - 1; i++) { // 등수에 따른 studs 배열 정렬
            for (let j = 0; j < studs.length - 1 - i; j++) {
                if (studs[j][9] > studs[j + 1][9]) {
                    let chg = studs[j];
                    studs[j] = studs[j + 1];
                    studs[j + 1] = chg;
                }
            }
        }

        /*
        sort를 사용하고 싶었으나, 2차원 배열에서의 정렬이 어려워, 자문을 구했고 버블 정렬로 하기로 함.
        이중 for문을 사용하여 전체 for문에서는 i = 0으로 하고, studs.length = 51에서 -1을 해준다.
        인덱스가 0~50까지이지만 length는 51로 표시되기에 -1을 해주고 
        -1을 해주는 이유가 궁금했는데 마지막 남은 1명은 자동으로 제자리에 있기 때문에 부등호를 '>'을 하는 것임. 
        
        전체 for문 : i = 0; i < 50, i++ 
        안쪽 for문 : j = 0; j < 50 - i  : i가 늘어날수록 꼴찌 등수부터 차례대로 정해진다. 그래서 그만큼 i 횟수가 필요없는 것임.
        if문 : studs[j=0][9] > studs[j=0 + 1][9]일 때, 이웃끼리 비교해서 정렬하는 방식이기에 +1을 더해줘서 비교를 한다. '>'인 이유는 j가 낮을수록 배열이 위에 있어야하기 때문. 등수에선 1이 높고 40이 낮다.
        studs[j=0][9] > studs[j=1][9]과 같이 이웃들끼리 비교하면서 최하위 등수를 받은 배열이 맨 밑으로 가게 한다.

        i가 49번째까지 올 동안 j가 50 - i가 될 때까지 반복작업. 
        
        */

        console.log(studs);

        // ----------------------------------------------------------------------------------------------------

        let studs2 = [ // 성별 별 등수(전체)
            [1, "여", "정서연", 97, 90, 92],
            [1, "여", "김도윤", 54, 80, 76],
            [3, "남", "정지우", 90, 11, 50],
            [3, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 14, 56, 98],
            [3, "남", "최민준", 52, 61, 85],
            [4, "여", "박서연", 15, 18, 42],
            [2, "남", "이민준", 90, 97, 98],
            [3, "남", "최민준", 51, 81, 64],
            [2, "남", "이민준", 86, 40, 90],
            [4, "여", "최도윤", 99, 90, 16],
            [4, "여", "김도윤", 93, 17, 98],
            [1, "남", "최민준", 14, 58, 54],
            [2, "여", "박도윤", 57, 16, 13],
            [1, "여", "김예린", 90, 97, 21],
            [1, "여", "최하윤", 61, 69, 82],
            [1, "남", "이지우", 96, 31, 35],
            [4, "여", "정서연", 97, 27, 35],
            [2, "여", "김도윤", 54, 80, 76],
            [2, "남", "정지우", 90, 11, 50],
            [2, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 14, 56, 98],
            [3, "여", "최민준", 52, 61, 85],
            [4, "여", "박서연", 15, 18, 42],
            [3, "여", "이민준", 90, 97, 98],
            [1, "남", "최민준", 51, 81, 64],
            [3, "남", "이민준", 86, 40, 90],
            [4, "남", "최도윤", 99, 90, 16],
            [3, "남", "김도윤", 93, 17, 98],
            [2, "남", "최민준", 14, 58, 54],
            [2, "여", "박도윤", 57, 16, 13],
            [2, "여", "김예린", 90, 97, 21],
            [2, "남", "최하윤", 61, 69, 82],
            [1, "여", "이지우", 96, 31, 35],
            [4, "여", "정서연", 97, 27, 35],
            [2, "여", "김도윤", 54, 80, 76],
            [3, "남", "정지우", 90, 11, 50],
            [1, "여", "박예준", 82, 88, 68],
            [4, "남", "박서연", 99, 56, 98],
            [3, "남", "최민준", 52, 61, 85],
            [1, "여", "박서연", 15, 18, 42],
            [3, "남", "이민준", 90, 97, 98],
            [2, "남", "최민준", 51, 81, 64],
            [3, "남", "이민준", 86, 70, 90],
            [4, "여", "최도윤", 99, 90, 16],
            [4, "여", "김도윤", 93, 17, 98],
            [2, "남", "최민준", 14, 58, 54],
            [2, "남", "박도윤", 57, 16, 13],
            [1, "여", "김예린", 90, 97, 21],
            [2, "남", "최하윤", 61, 69, 82],
            [1, "남", "이지우", 96, 99, 35],
        ];

        for (let i in studs2) { // 총점과 평균
            let tot = 0;
            for (let j of studs2[i].slice(3)) {
                tot += j;
            }
            studs2[i].push(tot);
            studs2[i].push((((tot / 3) * 100) | 0) / 100);
        }

        for (let i in studs2) { // 등급
            let grade = 0;
            const a = studs2[i][7]

            if (a >= 90) {
                grade = `<div class="su">수</div>`
            }
            else if (a >= 80) {
                grade = `<div class="woo">우</div>`
            }

            else if (a >= 70) {
                grade = `<div class="mi">미</div>`
            }

            else if (a >= 60) {
                grade = `<div class="yang">양</div>`
            }

            else {
                grade = `<div class="ga">가</div>`
            }

            studs2[i].push(grade)
        }

        for (let my_rank in studs2) { //등수
            let rank = 1;
            const my_gender = studs2[my_rank][1];
            for (let your_rank in studs2) {
                const your_gender = studs2[your_rank][1];
                if (my_gender == your_gender && studs2[my_rank][7] < studs2[your_rank][7]) {
                    rank++
                }
            }
            studs2[my_rank].push(rank)
        }

        /*
        기존 등수에서 my_gender와 your_gender를 추가하고, my_gender = studs2[my_rank=0][1], your_gender = studs2[your_rank=0][1]<- 성별

        if문에 my_gender == your_gender을 통해 같은 성별인 동시에, &&를 넣어서 기존 등수 체계까지 모두 만족해야지만 rank++할 수 있게 함.
        그러면 성별 별로 등수가 나타나게 됨.
        */

        for (let i = 0; i < studs2.length - 1; i++) { // 정렬
            for (let j = 0; j < studs2.length - 1 - i; j++) {
                if (studs2[j][9] > studs2[j + 1][9]) {
                    let chg = studs2[j];
                    studs2[j] = studs2[j + 1];
                    studs2[j + 1] = chg;
                }
            }
        }

        const male_studs = [];
        const female_studs = [];


        for (const student of studs2) { // 남여 구분
            const gender = student[1];

            if (gender === "남") {
                male_studs.push(student);
            } else if (gender === "여") {
                female_studs.push(student);
            }

        }

        console.log(male_studs)
        console.log(female_studs)

        // ----------------------------------------------------------------------------------------------------

        document.write(`<div class= logo1>2. 전체 등수</div>`) // 전체 등수

        let headerText = ['반', '성별', '성명', '국어', '영어', '수학', '총점', '평균', '등급', '등수'];
        let header = `<div class="row">`;
        for (const text of headerText) {
            header += `<div class="cell">${text}</div>`;
        }
        header += `</div>`;

        document.write(header)


        for (let i = 0; i <= 50 && i < studs.length; i++) {
            document.write(`<div class="allrow">`);
            for (let j = 0; j < studs[i].length; j++) {
                document.write(`<div class="allcell">${studs[i][j]}</div>`);
            }
            document.write(`</div>`);
        }

        // ----------------------------------------------------------------------------------------------------

        document.write(`<div class= logo1>4. 성별 등수(남자)</div>`) // 남자 등수

        let headerText2 = ['반', '성별', '성명', '국어', '영어', '수학', '총점', '평균', '등급', '등수'];
        let header2 = `<div class="row">`;
        for (const text of headerText2) {
            header2 += `<div class="cell">${text}</div>`;
        }
        header2 += `</div>`;

        document.write(header2)


        for (let i = 0; i <= 50 && i < male_studs.length; i++) {
            document.write(`<div class="allrow">`);
            for (let j = 0; j < male_studs[i].length; j++) {
                document.write(`<div class="allcell">${male_studs[i][j]}</div>`);
            }
            document.write(`</div>`);
        }

        // ----------------------------------------------------------------------------------------------------

        document.write(`<div class= logo1>4. 성별 등수(여자)</div>`) // 여자 등수

        let headerText3 = ['반', '성별', '성명', '국어', '영어', '수학', '총점', '평균', '등급', '등수'];
        let header3 = `<div class="row">`;
        for (const text of headerText3) {
            header3 += `<div class="cell">${text}</div>`;
        }
        header3 += `</div>`;

        document.write(header3)


        for (let i = 0; i <= 50 && i < female_studs.length; i++) {
            document.write(`<div class="allrow">`);
            for (let j = 0; j < female_studs[i].length; j++) {
                document.write(`<div class="allcell">${female_studs[i][j]}</div>`);
            }
            document.write(`</div>`);
        }

    </script>
</body>

</html>