<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ðŸ“— Student Scores</title>
  </head>
  <body>
    <script>
      /**
       * Random data * over 40 rows (class, gender, name, score - kor, eng, math)
       */
      const dataFrame = [
        [1, "ì—¬", "ì •ì„œì—°", 97, 90, 92],
        [1, "ì—¬", "ê¹€ë„ìœ¤", 54, 80, 76],
        [3, "ë‚¨", "ì •ì§€ìš°", 90, 11, 50],
        [3, "ì—¬", "ë°•ì˜ˆì¤€", 82, 88, 68],
        [4, "ë‚¨", "ë°•ì„œì—°", 14, 56, 98],
        [3, "ë‚¨", "ìµœë¯¼ì¤€", 52, 61, 85],
        [4, "ì—¬", "ë°•ì„œì—°", 15, 18, 42],
        [2, "ë‚¨", "ì´ë¯¼ì¤€", 90, 97, 98],
        [3, "ë‚¨", "ìµœë¯¼ì¤€", 51, 81, 64],
        [2, "ë‚¨", "ì´ë¯¼ì¤€", 86, 40, 90],
        [4, "ì—¬", "ìµœë„ìœ¤", 99, 90, 16],
        [4, "ì—¬", "ê¹€ë„ìœ¤", 93, 17, 98],
        [1, "ë‚¨", "ìµœë¯¼ì¤€", 14, 58, 54],
        [2, "ì—¬", "ë°•ë„ìœ¤", 57, 16, 13],
        [1, "ì—¬", "ê¹€ì˜ˆë¦°", 90, 97, 21],
        [1, "ì—¬", "ìµœí•˜ìœ¤", 61, 69, 82],
        [1, "ë‚¨", "ì´ì§€ìš°", 96, 31, 35],
        [4, "ì—¬", "ì •ì„œì—°", 97, 27, 35],
        [2, "ì—¬", "ê¹€ë„ìœ¤", 54, 80, 76],
        [2, "ë‚¨", "ì •ì§€ìš°", 90, 11, 50],
        [2, "ì—¬", "ë°•ì˜ˆì¤€", 82, 88, 68],
        [4, "ë‚¨", "ë°•ì„œì—°", 14, 56, 98],
        [3, "ì—¬", "ìµœë¯¼ì¤€", 52, 61, 85],
        [4, "ì—¬", "ë°•ì„œì—°", 15, 18, 42],
        [3, "ì—¬", "ì´ë¯¼ì¤€", 90, 97, 98],
        [1, "ë‚¨", "ìµœë¯¼ì¤€", 51, 81, 64],
        [3, "ë‚¨", "ì´ë¯¼ì¤€", 86, 40, 90],
        [4, "ë‚¨", "ìµœë„ìœ¤", 99, 90, 16],
        [3, "ë‚¨", "ê¹€ë„ìœ¤", 93, 17, 98],
        [2, "ë‚¨", "ìµœë¯¼ì¤€", 14, 58, 54],
        [2, "ì—¬", "ë°•ë„ìœ¤", 57, 16, 13],
        [2, "ì—¬", "ê¹€ì˜ˆë¦°", 90, 97, 21],
        [2, "ë‚¨", "ìµœí•˜ìœ¤", 61, 69, 82],
        [1, "ì—¬", "ì´ì§€ìš°", 96, 31, 35],
        [4, "ì—¬", "ì •ì„œì—°", 97, 27, 35],
        [2, "ì—¬", "ê¹€ë„ìœ¤", 54, 80, 76],
        [3, "ë‚¨", "ì •ì§€ìš°", 90, 11, 50],
        [1, "ì—¬", "ë°•ì˜ˆì¤€", 82, 88, 68],
        [4, "ë‚¨", "ë°•ì„œì—°", 99, 56, 98],
        [3, "ë‚¨", "ìµœë¯¼ì¤€", 52, 61, 85],
        [1, "ì—¬", "ë°•ì„œì—°", 15, 18, 42],
        [3, "ë‚¨", "ì´ë¯¼ì¤€", 90, 97, 98],
        [2, "ë‚¨", "ìµœë¯¼ì¤€", 51, 81, 64],
        [3, "ë‚¨", "ì´ë¯¼ì¤€", 86, 70, 90],
        [4, "ì—¬", "ìµœë„ìœ¤", 99, 90, 16],
        [4, "ì—¬", "ê¹€ë„ìœ¤", 93, 17, 98],
        [2, "ë‚¨", "ìµœë¯¼ì¤€", 14, 58, 54],
        [2, "ë‚¨", "ë°•ë„ìœ¤", 57, 16, 13],
        [1, "ì—¬", "ê¹€ì˜ˆë¦°", 90, 97, 21],
        [2, "ë‚¨", "ìµœí•˜ìœ¤", 61, 69, 82],
        [1, "ë‚¨", "ì´ì§€ìš°", 96, 99, 35],
      ];

      /**
       * Append sum and average
       */
      for (const row of dataFrame) {
        // Get entire scores and return result of sum and average
        const kor = row[3];
        const eng = row[4];
        const math = row[5];

        const sum = kor + eng + math;
        const average = sum / 3;
        row.push(sum, Number(average.toFixed(2)));
      }

      /**
       * Set the grade of each average
       */
      const backgroundColors = []; // backgroundColor will be stored and apply on style.

      for (const row of dataFrame) {
        const average = row[row.length - 1];

        let grade = []; // ex) [grade, color]

        // Grade standard (score >= 90 - 'ìˆ˜', score >= 80 - 'ìš°'... etc.)
        if (average >= 90) {
          grade = ["ìˆ˜", "red"];
        } else if (average >= 80) {
          grade = ["ìš°", "orange"];
        } else if (average >= 70) {
          grade = ["ë¯¸", "yellow"];
        } else if (average >= 60) {
          grade = ["ì–‘", "green"];
        } else {
          grade = ["ê°€", "skyblue"];
        }

        row.push(grade[0]);
        backgroundColors.push(grade[1]);
      }

      /**
       * 2. Sort rank of entire students (Descending order by bubble sort)
       */
      let lastSortedCount = 1;

      for (i = 0; i < dataFrame.length - 1; i++) {
        for (j = 0; j < dataFrame.length - lastSortedCount; j++) {
          let currentRowAverage = dataFrame[j][7];
          let nextRowAverage = dataFrame[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = dataFrame[j + 1];
            dataFrame[j + 1] = dataFrame[j];
            dataFrame[j] = temp;
          }
        }

        lastSortedCount++;
      }

      /**
       * 4. Sort rank by gender
       */
      lastSortedCount = 1;

      // Seperate row by gender
      let maleGroup = [];
      let femaleGroup = [];

      for (const row of dataFrame) {
        row[1] === "ë‚¨" ? maleGroup.push(row) : femaleGroup.push(row);
      }

      // Bubble sort by rank of each group
      for (i = 0; i < maleGroup.length - 1; i++) {
        for (j = 0; j < maleGroup.length - lastSortedCount; j++) {
          let currentRowAverage = maleGroup[j][7];
          let nextRowAverage = maleGroup[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = maleGroup[j + 1];
            maleGroup[j + 1] = maleGroup[j];
            maleGroup[j] = temp;
          }
        }

        lastSortedCount++;
      }

      // Initialize
      lastSortedCount = 1;

      for (i = 0; i < femaleGroup.length - 1; i++) {
        for (j = 0; j < femaleGroup.length - lastSortedCount; j++) {
          let currentRowAverage = femaleGroup[j][7];
          let nextRowAverage = femaleGroup[j + 1][7];

          if (nextRowAverage > currentRowAverage) {
            let temp = femaleGroup[j + 1];
            femaleGroup[j + 1] = femaleGroup[j];
            femaleGroup[j] = temp;
          }
        }

        lastSortedCount++;
      }

      /**
       * 5. Seperate by classes, and grouping by gender.
       */
      const classA = [];
      const classB = [];
      const classC = [];
      const classD = [];

      for (const row of dataFrame) {
        switch (row[0]) {
          case 1:
            classA.push(row);
            break;
          case 2:
            classB.push(row);
            break;
          case 3:
            classC.push(row);
            break;
          default:
            classD.push(row);
        }
      }

      const classGroup = [classA, classB, classC, classD];

      for (const pickedClass of classGroup) {
        maleGroup = [];
        femaleGroup = [];

        for (const row of pickedClass) {
          row[1] === "ë‚¨" ? maleGroup.push(row) : femaleGroup.push(row);
        }

        // Bubble sort by rank of each group
        for (i = 0; i < maleGroup.length - 1; i++) {
          for (j = 0; j < maleGroup.length - lastSortedCount; j++) {
            let currentRowAverage = maleGroup[j][7];
            let nextRowAverage = maleGroup[j + 1][7];

            if (nextRowAverage > currentRowAverage) {
              let temp = maleGroup[j + 1];
              maleGroup[j + 1] = maleGroup[j];
              maleGroup[j] = temp;
            }
          }

          lastSortedCount++;
        }

        // Initialize
        lastSortedCount = 1;

        for (i = 0; i < femaleGroup.length - 1; i++) {
          for (j = 0; j < femaleGroup.length - lastSortedCount; j++) {
            let currentRowAverage = femaleGroup[j][7];
            let nextRowAverage = femaleGroup[j + 1][7];

            if (nextRowAverage > currentRowAverage) {
              let temp = femaleGroup[j + 1];
              femaleGroup[j + 1] = femaleGroup[j];
              femaleGroup[j] = temp;
            }
          }

          lastSortedCount++;
        }

        console.log(maleGroup, femaleGroup);
      }
    </script>
  </body>
</html>
